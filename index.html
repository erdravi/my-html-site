<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Grocery List App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4A90E2;
      color: white;
      padding: 10px;
      text-align: center;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background-color: #f1f1f1;
    }
    nav button {
      flex: 1;
      padding: 10px;
      border: none;
      background-color: #ddd;
      cursor: pointer;
      font-size: 16px;
    }
    nav button.active {
      background-color: #4A90E2;
      color: white;
    }
    .tab {
      display: none;
      padding: 20px;
    }
    .tab.active {
      display: block;
    }
    input, select, button {
      margin: 5px;
      padding: 5px;
      font-size: 14px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 5px 0;
    }
    .checked {
      text-decoration: line-through;
      color: gray;
    }
    .delete-btn {
      margin-left: 10px;
      color: red;
      cursor: pointer;
    }
    .summary {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>Grocery List Manager</h1>
  </header>

  <nav>
    <button onclick="showTab('master')" class="active">Master</button>
    <button onclick="showTab('buy')">Buy List</button>
    <button onclick="showTab('checklist')">Checklist</button>
  </nav>

  <div id="master" class="tab active">
    <h2>Master Items</h2>
    <input type="text" id="masterItem" placeholder="Enter item" />
    <button onclick="addMasterItem()">Add</button>
    <ul id="masterList"></ul>
    <div class="summary">Total items: <span id="masterCount">0</span></div>
  </div>

  <div id="buy" class="tab">
    <h2>Buy List</h2>
    <select id="buyItem">
      <option value="">Select item</option>
    </select>
    <input type="number" id="buyQuantity" placeholder="Quantity" />
    <select id="buyUnit">
      <option value="gram">gram</option>
      <option value="kg">kg</option>
      <option value="small pack">small pack</option>
      <option value="medium pack">medium pack</option>
      <option value="large pack">large pack</option>
      <option value="liters">liters</option>
      <option value="item">item</option>
    </select>
    <input type="month" id="buyMonth" />
    <button onclick="addToBuyList()">Add</button>
    <ul id="buyList"></ul>
    <div class="summary">Total buy items: <span id="buyCount">0</span></div>
  </div>

  <div id="checklist" class="tab">
    <h2>Checklist</h2>
    <select id="monthSelect" onchange="filterChecklist()">
      <option value="">All Months</option>
    </select>
    <ul id="checklistItems"></ul>
    <div class="summary">
      Purchased: <span id="purchasedCount">0</span> | Pending: <span id="pendingCount">0</span>
    </div>
  </div>

  <script>
    const masterList = JSON.parse(localStorage.getItem("masterList")) || [];
    const buyList = JSON.parse(localStorage.getItem("buyList")) || [];
    const checklist = JSON.parse(localStorage.getItem("checklist")) || [];

    function getCurrentMonth() {
      const now = new Date();
      return now.toISOString().slice(0, 7); // YYYY-MM
    }

    function showTab(tabId) {
      document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
      document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
      document.getElementById(tabId).classList.add("active");
      event.target.classList.add("active");

      if (tabId === "master") renderMasterList();
      if (tabId === "buy") {
        renderBuyList();
        updateBuyDropdown();
        document.getElementById("buyMonth").value = getCurrentMonth();
      }
      if (tabId === "checklist") {
        populateMonthDropdown();
        document.getElementById("monthSelect").value = getCurrentMonth();
        filterChecklist();
      }
    }

    function addMasterItem() {
      const item = document.getElementById("masterItem").value.trim();
      if (item && !masterList.includes(item)) {
        masterList.push(item);
        localStorage.setItem("masterList", JSON.stringify(masterList));
        document.getElementById("masterItem").value = "";
        renderMasterList();
      }
    }

    function deleteMasterItem(index) {
      masterList.splice(index, 1);
      localStorage.setItem("masterList", JSON.stringify(masterList));
      renderMasterList();
    }

    function renderMasterList() {
      const ul = document.getElementById("masterList");
      ul.innerHTML = "";
      masterList.forEach((item, i) => {
        ul.innerHTML += `<li>${i + 1}. ${item} <span class="delete-btn" onclick="deleteMasterItem(${i})">üóëÔ∏è</span></li>`;
      });
      document.getElementById("masterCount").innerText = masterList.length;
    }

    function updateBuyDropdown() {
      const dropdown = document.getElementById("buyItem");
      dropdown.innerHTML = `<option value="">Select item</option>`;
      masterList.forEach(item => {
        const opt = document.createElement("option");
        opt.value = item;
        opt.textContent = item;
        dropdown.appendChild(opt);
      });
    }

    function addToBuyList() {
      const item = document.getElementById("buyItem").value;
      const quantity = document.getElementById("buyQuantity").value;
      const unit = document.getElementById("buyUnit").value;
      const date = document.getElementById("buyMonth").value;

      if (item && quantity && unit && date) {
        buyList.push({ item, quantity, unit, date });
        localStorage.setItem("buyList", JSON.stringify(buyList));
        renderBuyList();
        updateChecklistData();
      }
    }

    function deleteBuyItem(index) {
      buyList.splice(index, 1);
      localStorage.setItem("buyList", JSON.stringify(buyList));
      renderBuyList();
      updateChecklistData();
    }

    function renderBuyList() {
      const ul = document.getElementById("buyList");
      ul.innerHTML = "";
      buyList.forEach((b, i) => {
        ul.innerHTML += `<li>${i + 1}. ${b.item} - ${b.quantity} ${b.unit} (${b.date}) <span class="delete-btn" onclick="deleteBuyItem(${i})">üóëÔ∏è</span></li>`;
      });
      document.getElementById("buyCount").innerText = buyList.length;
    }

    function updateChecklistData() {
      checklist.length = 0;
      buyList.forEach(b => checklist.push({ ...b, checked: false }));
      localStorage.setItem("checklist", JSON.stringify(checklist));
    }

    function populateMonthDropdown() {
      const dropdown = document.getElementById("monthSelect");
      const months = [...new Set(checklist.map(c => c.date.slice(0, 7)))];
      dropdown.innerHTML = `<option value="">All Months</option>`;
      months.forEach(m => {
        const opt = document.createElement("option");
        opt.value = m;
        opt.textContent = m;
        dropdown.appendChild(opt);
      });
    }

    function toggleChecked(checkbox, index) {
      checklist[index].checked = checkbox.checked;
      localStorage.setItem("checklist", JSON.stringify(checklist));
      filterChecklist();
    }

    function filterChecklist() {
      const month = document.getElementById("monthSelect").value;
      const ul = document.getElementById("checklistItems");
      const filtered = month ? checklist.filter(c => c.date.startsWith(month)) : checklist;

      ul.innerHTML = "";
      let purchased = 0;
      filtered.forEach((c, i) => {
        if (c.checked) purchased++;
        ul.innerHTML += `<li><input type="checkbox" onchange="toggleChecked(this, ${i})" ${c.checked ? "checked" : ""} />
        <span class="${c.checked ? 'checked' : ''}">${c.item} - ${c.quantity} ${c.unit}</span></li>`;
      });
      document.getElementById("purchasedCount").innerText = purchased;
      document.getElementById("pendingCount").innerText = filtered.length - purchased;
    }

    // Initialize
    renderMasterList();
    renderBuyList();
    populateMonthDropdown();
    filterChecklist();
  </script>
</body>
</html>

